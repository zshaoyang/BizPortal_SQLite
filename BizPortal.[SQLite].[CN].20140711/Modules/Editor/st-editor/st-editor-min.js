var a;function STEditor(b,c){if(STEditor.isset(window.STEditor))if(typeof STEditor.Instances[b]=="undefined"){this.TargetId=b;this.loadOptions(c);this.init();STEditor.Instances[b]=this}}STEditor.AppInfo={Name:"SleepingTiger.STEditor",Version:"1.0",Edition:"Beta",Build:"20131018",Author:"Iron",Copyright:"2013 1986z.com",WebSite:"http://www.1986z.com/"};STEditor.LoadedFiles=[];STEditor.Lang={};STEditor.Plugins={};
STEditor.ToolbarConfigs={All:["b","i","u","s","remove_format","-","link","unlink","img","fl","-","code","quote","anchor","-","left","center","right","full","-","ol","ul","fscreen","|","h","font","size","fore_color","bg_color","-","sub","sup","hr","smiley","-","source","about"],Basic:["source","-","b","i","u","s","remove_format","-","link","unlink","img","fore_color","bg_color","-","fscreen","about"],Mini:["source","-","b","i","u","s","-","link","unlink","-","about"]};STEditor.Instances={};
STEditor.get=function(b){return STEditor.Instances[b]};STEditor.create=function(b,c){new STEditor(b,c)};STEditor.getObject=function(b){return document.getElementById(b)};STEditor.getIFrameWindow=function(b){var c=null;try{c=document.frames[b]}catch(d){}if(c==null)try{c=STEditor.getObject(b).contentWindow}catch(e){}return c};STEditor.attachEvent=function(b,c,d){window.attachEvent?b.attachEvent("on"+c,function(e){d.call(b,e)}):b.addEventListener(c,function(e){d(e)},false)};
STEditor.isset=function(b){return typeof b!="undefined"};STEditor.inArray=function(b,c){for(var d=0,e=c.length;d<e;d++)if(b===c[d])return d;return-1};STEditor.getBaseUrl=function(){var b=document.getElementsByTagName("script");if(typeof b=="object"&&b.length>0)for(var c=0;c<b.length;c++){var d=b[c];if(d.src){d=d.src;if(d.indexOf("?")>0)d=d.substring(0,d.indexOf("?"));if(d.indexOf("st-editor")>-1)return d.substring(0,d.lastIndexOf("/")+1)}}return"/"};
STEditor.getIEVersion=function(){var b=-1,c=navigator.userAgent.toLowerCase();if(c.indexOf("msie")!=-1&&document.all){b=c.substr(c.indexOf("msie"));b=b.substr(0,b.indexOf("."));b=b.replace("msie","");b=parseInt(b)}return b};
STEditor.importScript=function(b){if(!(STEditor.inArray(b,STEditor.LoadedFiles)>-1)){var c=document.getElementsByTagName("head").item(0);c||(c=document.getElementsByTagName("body").item(0));if(c){var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("src",b);c.appendChild(d)}}};
STEditor.importStyleSheet=function(b){if(STEditor.inArray(b,STEditor.LoadedFiles)>-1==false){var c=document.getElementsByTagName("head").item(0);c||(c=document.getElementsByTagName("body").item(0));if(c){var d=document.createElement("link");d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");d.setAttribute("href",b);c.appendChild(d)}}};a=STEditor.prototype;a.TargetId=null;a.BaseUrl="";a.EditMode=1;a.UBBMode=0;a.SaveMode=0;a.FullScreen=0;a.Skin="default";a.Lang="en";
a.Size={Width:null,Height:null};a.Offset={Position:null,Top:null,Left:null,ZIndex:null};a.Toolbar=null;a.FormInput=null;a.EditorWindow=null;a.Selection=null;a.Range=null;a.RangeText=null;a.getTagObject=function(b,c){var d=null;if(b&&c){d=STEditor.getObject(this.TargetId+"_EditorFactory");d.innerHTML=b;d=d.getElementsByTagName(c).item(0)}return d};a.getLang=function(b){return STEditor.Lang[this.Lang][b]};
a.convertRGBToHex=function(b){var c="",d=/([0-9]+)[, ]+([0-9]+)[, ]+([0-9]+)/.exec(b);if(d){for(b=1;b<d.length;b++)c+=("0"+parseInt(d[b]).toString(16)).slice(-2);c="#"+c}else c=b;return c};a.htmlEncode=function(b){if(b){b=b.replace(/&/igm,"&amp;");b=b.replace(/</igm,"&lt;");b=b.replace(/>/igm,"&gt;");b=b.replace(/\"/igm,"&quot;");b=b.replace(/ /igm,"&nbsp;")}return b};
a.htmlDecode=function(b){if(b){b=b.replace(/&lt;/igm,"<");b=b.replace(/&gt;/igm,">");b=b.replace(/&quot;/igm,'"');b=b.replace(/&nbsp;/igm," ");b=b.replace(/&amp;/igm,"&")}return b};a.batchReplace=function(b,c){for(var d=true,e=0;e<c.length;e++)c[e][2]||(b=b.replace(c[e][0],c[e][1]));for(;d;){d=false;for(e=0;e<c.length;e++)if(c[e][2]&&b.search(c[e][0])!=-1){d=true;b=b.replace(c[e][0],c[e][1])}}return b};
a.convertHTMLToXHTML=function(b){if(b){b=b.replace(/<br.*?>/ig,"<br />");b=b.replace(/(<hr[^>]*)>/ig,"$1 />");b=b.replace(/(<img[^>]*)>/ig,"$1 />")}return b};
a.removeHtml=function(b){if(b){b=b.replace(/<script[^>]*>[\s\S]*?<\/script[^>]*>/gim,"");b=b.replace(/<(\/?)(script|i?frame|style|html|head|body|title|link|meta|object|\?|\%)([^>]*?)>/gi,"");b=b.replace(/<([a-z]+)+\s*(?:onerror|onload|onunload|onresize|onblur|onchange|onclick|ondblclick|onfocus|onkeydown|onkeypress|onkeyup|onmousemove|onmousedown|onmouseout|onmouseover|onmouseup|onselect)[^>]*>/gi,"<$1>")}return b};
a.convertXHTMLToUBB=function(b){if(b){var c=this,d=[[/<br \/>/ig,"[br]",false],[/<hr[^>]*?\/>/ig,"[hr]",false],[/<p>([^<]*?)<\/p>/igm,"[p]$1[/p]",true],[/<b>([^<]*?)<\/b>/igm,"[b]$1[/b]",true],[/<s>([^<]*?)<\/s>/igm,"[s]$1[/s]",true],[/<strong>([^<]*?)<\/strong>/igm,"[b]$1[/b]",true],[/<i>([^<]*?)<\/i>/igm,"[i]$1[/i]",true],[/<em>([^<]*?)<\/em>/igm,"[i]$1[/i]",true],[/<u>([^<]*?)<\/u>/igm,"[u]$1[/u]",true],[/<ol>([^<]*?)<\/ol>/igm,"[ol]$1[/ol]",true],[/<ul>([^<]*?)<\/ul>/igm,"[ul]$1[/ul]",true],[/<li>([^<]*?)<\/li>/igm,
"[li]$1[/li]",true],[/<sub>([^<]*?)<\/sub>/igm,"[sub]$1[/sub]",true],[/<sup>([^<]*?)<\/sup>/igm,"[sup]$1[/sup]",true],[/<a[^<]*?class="post_anchor"[^>]*?>[^>]*?<\/a>/igm,function(h){h=c.getTagObject(h,"a");var i="";if(h.id)i=h.id;if(h.getAttribute("id"))i=h.getAttribute("id");if(i!="")return"[anchor]"+i+"[/anchor]";return""},true],[/<span[^>]*style="color:([^>;]+);?"[^>]*>([^<]*?)<\/span>/igm,"[color=$1]$2[/color]",true],[/<span[^>]*style="background-color:([^>;]+);?"[^>]*>([^<]*?)<\/span>/igm,"[bgcolor=$1]$2[/bgcolor]",
true],[/<span[^>]*style="font-weight:bold;?"[^>]*>([^<]*?)<\/span>/igm,"[b]$1[/b]",true],[/<span[^>]*style="font-style:italic;?"[^>]*>([^<]*?)<\/span>/igm,"[i]$1[/i]",true],[/<span[^>]*style="text-decoration:underline;?"[^>]*>([^<]*?)<\/span>/igm,"[u]$1[/u]",true],[/<span[^>]*style="text-decoration:line-through;?"[^>]*>([^<]*?)<\/span>/igm,"[s]$1[/s]",true],[/<font\s[^>]*?>([^<]*?)<\/font>/igm,function(h,i){i=i;h=c.getTagObject(h,"font");if(h.getAttribute("color"))i="[color="+c.convertRGBToHex(h.getAttribute("color"))+
"]"+i+"[/color]";if(h.style.color)i="[color="+c.convertRGBToHex(h.style.color)+"]"+i+"[/color]";if(h.style.backgroundColor)i="[bgcolor="+c.convertRGBToHex(h.style.backgroundColor)+"]"+i+"[/bgcolor]";return i},true],[/<p[^>]*style="color:([^>;]+);?"[^>]*>([^<]*?)<\/p>/igm,"[p][color=$1]$2[/color][/p]",true],[/<p[^>]*style="background-color:([^>;]+);?"[^>]*>([^<]*?)<\/p>/igm,"[p][bgcolor=$1]$2[/bgcolor][/p]",true],[/<p[^>]*style="font-weight:bold;?"[^>]*>([^<]*?)<\/p>/igm,"[p][b]$1[/b][/p]",true],[/<p[^>]*style="font-style:italic;?"[^>]*>([^<]*?)<\/p>/igm,
"[p][i]$1[/i][/p]",true],[/<p[^>]*style="text-decoration:underline;?"[^>]*>([^<]*?)<\/p>/igm,"[p][u]$1[/u][/p]",true],[/<p[^>]*style="text-decoration:line-through;?"[^>]*>([^<]*?)<\/p>/igm,"[p][s]$1[/s][/p]",true],[/<p[^>]*?align="?(\w+)"?[^>]*?>([^<]*?)<\/p>/igm,"[align=$1]$2[/align]",true],[/<p[^>]*?style="text-align:(\w+);?"[^>]*?>([^<]*?)<\/p>/igm,"[align=$1]$2[/align]",true],[/<div[^>]*?align="?(\w+)"?[^>]*?>([^<]*?)<\/div>/igm,"[align=$1]$2[/align]",true],[/<div[^>]*?style="text-align:(\w+?);?"[^>]*?>([^<]*?)<\/div>/igm,
"[align=$1]$2[/align]",true],[/<a[^>]*?href="([^>]+?);?"[^>]*?>([^<]*?)<\/a>/igm,"[url=$1]$2[/url]",true],[/<img[^>]*?src="([^>]+?);?"[^>]*?>/igm,"[img]$1[/img]",true],[/\]\[br\]\[/igm,"] [",true],[/\[br\]\[\/p\]/igm,"[/p]",true],[/\[\/p\]\[p\]/igm,"[/p]\r\n[p]",true]];for(var e in STEditor.Plugins){var g=STEditor.Plugins[e];if(STEditor.isset(g.XHTMLToUBB)){g=g.XHTMLToUBB(b,c);for(var f=0;f<g.length;f++)d.push(g[f])}}b=c.batchReplace(b,d);b=b.replace(/<[^>]*>/igm,"")}return b};
a.convertUBBToXHTML=function(b){if(b){var c=[[/\[br\]/igm,"<br />",false],[/\[hr\]/igm,"<hr />",false],[/\[p\]([^\[]*?)\[\/p\]/igm,"<p>$1</p>",true],[/\[b\]([^\[]*?)\[\/b\]/igm,"<b>$1</b>",true],[/\[i\]([^\[]*?)\[\/i\]/igm,"<i>$1</i>",true],[/\[u\]([^\[]*?)\[\/u\]/igm,"<u>$1</u>",true],[/\[s\]([^\[]*?)\[\/s\]/igm,'<span style="text-decoration:line-through;">$1</span>',true],[/\[ol\]([^\[]*?)\[\/ol\]/igm,"<ol>$1</ol>",true],[/\[ul\]([^\[]*?)\[\/ul\]/igm,"<ul>$1</ul>",true],[/\[li\]([^\[]*?)\[\/li\]/igm,
"<li>$1</li>",true],[/\[sub\]([^\[]*?)\[\/sub\]/igm,"<sub>$1</sub>",true],[/\[sup\]([^\[]*?)\[\/sup\]/igm,"<sup>$1</sup>",true],[/\[color=([^\]]*)\]([^\[]*?)\[\/color\]/igm,'<span style="color:$1;">$2</span>',true],[/\[bgcolor=([^\]]*)\]([^\[]*?)\[\/bgcolor\]/igm,'<span style="background-color:$1;">$2</span>',true],[/\[align=([^\]]*)\]([^\[]*?)\[\/align\]/igm,'<div style="text-align:$1;" align="$1">$2</div>',true],[/\[url=([^\]]*)\]([^\[]*?)\[\/url\]/igm,'<a href="$1">$2</a>',true],[/\[img\]([^\[]*?)\[\/img\]/igm,
'<img src="$1" class="post_img" />',true],[/\[anchor\]([^\[]*?)\[\/anchor\]/igm,'<a id="$1" class="post_anchor">&nbsp;</a>',true]];for(var d in STEditor.Plugins){var e=STEditor.Plugins[d];if(STEditor.isset(e.UBBToXHTML)){e=e.UBBToXHTML(b,this);for(var g=0;g<e.length;g++)c.push(e[g])}}b=this.batchReplace(b,c)}return b};
a.loadOptions=function(b){this.Size={Width:null,Height:null};this.Offset={Position:null,Top:null,Left:null,ZIndex:null};this.Skin="default";this.Lang="en";this.FormInput=this.Toolbar=null;this.SaveMode=this.UBBMode=0;if(STEditor.isset(b)){if(STEditor.isset(b.Width))this.Size.Width=parseInt(b.Width);if(STEditor.isset(b.Height))this.Size.Height=parseInt(b.Height);if(STEditor.isset(b.Skin))this.Skin=b.Skin;if(STEditor.isset(b.Lang))this.Lang=b.Lang;if(STEditor.isset(b.ToolbarConfig))this.Toolbar=STEditor.ToolbarConfigs[b.ToolbarConfig];
if(STEditor.isset(b.Toolbar))this.Toolbar=b.Toolbar;if(STEditor.isset(b.UBBMode))this.UBBMode=b.UBBMode;if(STEditor.isset(b.SaveMode))this.SaveMode=b.SaveMode}};a.buildStyleSheet=function(){STEditor.importStyleSheet(this.BaseUrl+"themes/"+this.Skin+"/editor.css?v="+STEditor.AppInfo.Build)};a.buildLangScript=function(){STEditor.importScript(this.BaseUrl+"lang/"+this.Lang+".js?v="+STEditor.AppInfo.Build)};
a.setFormInputValue=function(){var b=this.getHTML();b=this.convertHTMLToXHTML(b);if(this.SaveMode==0){b=this.convertXHTMLToUBB(b);b=this.removeHtml(b)}this.FormInput.value=b};a.getHTML=function(){return this.EditorWindow.document.body.innerHTML};a.getUBB=function(){var b=this.getHTML();b=this.convertHTMLToXHTML(b);b=this.removeHtml(b);return b=this.convertXHTMLToUBB(b)};
a.loadSelection=function(){if(this.EditorWindow.getSelection){this.Selection=this.EditorWindow.getSelection();this.Range=this.Selection.getRangeAt(0);this.RangeText=this.Range.toString()}else{this.Selection=this.EditorWindow.document.selection;this.Range=this.Selection.createRange();this.RangeText=this.Range.text}};a.reselectRange=function(){try{this.RangeText?this.Range.select():this.Range.focus()}catch(b){}};
a.createMask=function(){var b=STEditor.getObject(this.TargetId+"_EditorContainer");if(b){var c=document.createElement("div");c.setAttribute("id",this.TargetId+"_EditorMask");c.style.position="absolute";c.style.top="-1px";c.style.left="-1px";c.style.background="#FFFFFF";c.style.filter="Alpha(Opacity=60)";c.style.opacity="0.6";c.style.width=b.offsetWidth+"px";c.style.height=b.offsetHeight+"px";c.style.zIndex="100";b.appendChild(c);c=document.createElement("div");c.setAttribute("id",this.TargetId+"_EditorMaskPanel");
c.style.position="absolute";c.style.top="35%";c.style.left="35%";c.style.zIndex="101";c.className="STEditorMaskPanel";b.appendChild(c)}};
a.buildMaskPanel=function(b){if(b){var c=this,d=c.TargetId+"_EditorMaskPanel",e=c.TargetId+"_EditorMaskPanelCloser",g=STEditor.getObject(d);if(!g){c.createMask();g=STEditor.getObject(d)}if(g){d='<div class="STEditorMaskPanelInner">';d+=b;d+='<div id="'+e+'" class="STEditorMaskPanelCloser"><img src="'+c.BaseUrl+"themes/"+c.Skin+'/images/close.gif" /></div>';d+="</div>";g.style.display="none";g.innerHTML=d;g.style.display="block";g.style.marginLeft=0-Math.floor(g.offsetWidth/2)+"px";g.style.marginTop=
0-Math.floor(g.offsetHeight/2)+14+"px";b=STEditor.getObject(e);STEditor.attachEvent(b,"click",function(){c.closeMaskPanel()})}}};a.closeMaskPanel=function(){var b=STEditor.getObject(this.TargetId+"_EditorContainer");if(b){var c=STEditor.getObject(this.TargetId+"_EditorMask"),d=STEditor.getObject(this.TargetId+"_EditorMaskPanel");if(c&&d){b.removeChild(c);b.removeChild(d)}}};
a.buildColorTable=function(b,c){var d=this,e=0,g=new Array("00","88","CC","FF"),f=g.length,h='<table cellpadding="0" cellspacing="5" class="STEditorColorPickerTable">\n';h+="\t<tr>\n";h+='\t\t<td colspan="8">'+d.getLang("ColorPicker")+"</td>\n";h+="\t</tr>\n";h+="\t<tr>\n";for(var i=0;i<f;i++)for(var k=0;k<f;k++)for(var j=0;j<f;j++){e+=1;var l=""+g[i]+g[k]+g[j]+"",n=d.TargetId+"_"+b+"_PickerBtn_"+l;h+='\t\t<td><img id="'+n+'" src="'+d.BaseUrl+"themes/"+d.Skin+'/images/space.gif" style="background: #'+
l+';" data="'+l+'" alt="'+l+'" title="'+l+'" /></td>\n';if(e%8==0&&e!=f*f*f){h+="\t</tr>\n";h+="\t<tr>\n"}}h+="\t\t</tr>\n";h+="</table>";d.buildMaskPanel(h);for(i=0;i<f;i++)for(k=0;k<f;k++)for(j=0;j<f;j++){l=""+g[i]+g[k]+g[j]+"";n=d.TargetId+"_"+b+"_PickerBtn_"+l;e=STEditor.getObject(n);STEditor.attachEvent(e,"click",function(m){m=(m.target||window.event.srcElement).getAttribute("data");d.executeToolbarItem(c,"#"+m)})}};a.buildForeColorTable=function(){this.buildColorTable("ForeColor","fore_color_callback")};
a.buildBackColorTable=function(){this.buildColorTable("BackColor","bg_color_callback")};
a.buildCommonInputTable=function(b,c,d,e){var g=this,f=g.TargetId+"_EditorText_"+b,h=g.TargetId+"_EditorOkBtn_"+b;b=g.TargetId+"_EditorCancelBtn_"+b;var i='<div class="STEditor_Common_Table">\n';i+='\t<div class="title">'+c+g.getLang("Colon")+"</div>\n";i+='\t<div class="item"><input id="'+f+'" type="text" value="'+d+'" class="text" ondblclick="this.select();" /></div>\n';i+='\t<div class="tool"><input id="'+h+'" type="button" value="'+g.getLang("OK")+'" class="btn" />&nbsp;<input id="'+b+'" type="button" value="'+
g.getLang("Cancel")+'" class="btn" /></div>\n';i+="</div>";g.buildMaskPanel(i);var k=STEditor.getObject(f);c=STEditor.getObject(h);d=STEditor.getObject(b);STEditor.attachEvent(c,"click",function(){g.executeToolbarItem(e,k.value)});STEditor.attachEvent(d,"click",function(){g.closeMaskPanel()})};a.buildAnchorTable=function(){this.buildCommonInputTable("anchor",this.getLang("AnchorName"),"","anchor_callback")};
a.buildLinkTable=function(){this.buildCommonInputTable("link",this.getLang("LinkURL"),"http://","link_callback")};a.buildImageTable=function(){this.buildCommonInputTable("img",this.getLang("ImageURL"),"http://","img_callback")};
a.switchToFullScreen=function(){var b=STEditor.getObject(this.TargetId+"_EditorContainer"),c=STEditor.getObject(this.TargetId+"_ToolbarPanel"),d=window.screen.availWidth-15,e=window.screen.availHeight-180;document.body.style.width=d+"px";document.body.style.height=e+"px";document.body.style.overflow="hidden";b.style.position="absolute";b.style.zIndex=9999999;b.style.width=d+"px";b.style.height=e+"px";b.style.top=0;b.style.left=0;b=STEditor.getObject(this.TargetId+"_SourceBox");b.style.width=d-10+
"px";b.style.maxWidth=d-10+"px";b.style.height=e-c.offsetHeight-15+"px";b.style.maxHeight=e-c.offsetHeight-15+"px";b=STEditor.getObject(this.TargetId+"_EditorArea");b.style.width=d+"px";b.style.height=e-c.offsetHeight+"px";STEditor.getObject(this.getToolbarItemLinkId("fscreen")).className="toolbar_item_active";window.scrollTo(0,0);this.FullScreen=1};
a.switchToNormalScreen=function(){var b=STEditor.getObject(this.TargetId+"_EditorContainer"),c=STEditor.getObject(this.TargetId+"_ToolbarPanel");document.body.style.width="";document.body.style.height="";document.body.style.overflow="";b.style.position=this.Offset.Position;b.style.zIndex=this.Offset.ZIndex;b.style.width=this.Size.Width+"px";b.style.height=this.Size.Height+"px";b.style.top=this.Offset.Top;b.style.left=this.Offset.Left;var d=STEditor.getObject(this.TargetId+"_SourceBox");d.style.width=
this.Size.Width-10+"px";d.style.maxWidth=this.Size.Width-10+"px";d.style.height=this.Size.Height-c.offsetHeight-15+"px";d.style.maxHeight=this.Size.Height-c.offsetHeight-15+"px";d=STEditor.getObject(this.TargetId+"_EditorArea");d.style.width=this.Size.Width+"px";d.style.height=this.Size.Height-c.offsetHeight+"px";STEditor.getObject(this.getToolbarItemLinkId("fscreen")).className="toolbar_item";window.scrollTo(b.offsetLeft,b.offsetTop);this.FullScreen=0};
a.switchSourceMode=function(){if(this.EditMode==1){var b=this.getHTML();this.EditMode=0;b=this.convertHTMLToXHTML(b);b=this.convertXHTMLToUBB(b);b=this.removeHtml(b);STEditor.getObject(this.getToolbarItemLinkId("source")).className="toolbar_item_active";var c=STEditor.getObject(this.TargetId+"_SourceBox");c.style.display="";c.value=b;STEditor.getObject(this.TargetId+"_EditorArea").style.display="none"}};
a.switchNormalMode=function(){if(this.EditMode==0){var b=STEditor.getObject(this.TargetId+"_SourceBox"),c=b.value;this.EditMode=1;c=this.convertUBBToXHTML(c);STEditor.getObject(this.getToolbarItemLinkId("source")).className="toolbar_item";b.style.display="none";STEditor.getObject(this.TargetId+"_EditorArea").style.display="";this.EditorWindow.document.body.innerHTML=c}};
a.executeToolbarItem=function(b,c){if(this.EditMode==1)switch(b){case "anchor":this.buildAnchorTable();this.loadSelection();break;case "anchor_callback":this.closeMaskPanel();this.reselectRange();this.insertHTML(this.RangeText+'<a id="'+c+'" class="post_anchor">&nbsp;</a>');break;case "b":this.executeEditorCommand("bold");break;case "bg_color":this.buildBackColorTable();break;case "bg_color_callback":this.closeMaskPanel();try{this.executeEditorCommand("bgcolor",c)}catch(d){this.executeEditorCommand("backcolor",
c)}break;case "center":this.executeEditorCommand("justifycenter");break;case "fore_color":this.buildForeColorTable();break;case "fore_color_callback":this.closeMaskPanel();this.executeEditorCommand("forecolor",c);break;case "full":this.executeEditorCommand("justifyfull");break;case "fscreen":this.FullScreen==1?this.switchToNormalScreen():this.switchToFullScreen();break;case "hr":this.executeEditorCommand("InsertHorizontalRule");break;case "i":this.executeEditorCommand("italic");break;case "img":this.buildImageTable();
this.loadSelection();break;case "img_callback":this.closeMaskPanel();this.reselectRange();this.executeEditorCommand("insertimage",c);break;case "left":this.executeEditorCommand("justifyleft");break;case "link":this.buildLinkTable();this.loadSelection();break;case "link_callback":this.closeMaskPanel();this.reselectRange();this.executeEditorCommand("createlink",c);break;case "ol":this.executeEditorCommand("insertorderedlist");break;case "right":this.executeEditorCommand("justifyright");break;case "remove_format":this.executeEditorCommand("removeformat");
break;case "s":this.loadSelection();this.insertHTML('<span style="text-decoration:line-through;">'+this.htmlEncode(this.RangeText)+"</span>");break;case "source":this.switchSourceMode();break;case "sub":this.loadSelection();this.insertHTML("<sub>"+this.htmlEncode(this.RangeText)+"</sub>");break;case "sup":this.loadSelection();this.insertHTML("<sup>"+this.htmlEncode(this.RangeText)+"</sup>");break;case "u":this.executeEditorCommand("underline");break;case "ul":this.executeEditorCommand("insertunorderedlist");
break;case "unlink":this.executeEditorCommand("unlink");break;default:this.loadPlugin(b);this.executePlugin(b);break}else b=="source"?this.switchNormalMode():alert(this.getLang("SourceModeError"))};a.isPlugin=function(b){return STEditor.inArray(b,["anchor","b","bg_color","center","fscreen","full","fore_color","hr","i","img","left","link","ol","right","remove_format","s","sub","sup","source","u","ul","unlink"])<0};a.getPlugin=function(b){return STEditor.Plugins[b]};a.executePlugin=function(b){STEditor.Plugins[b].Execute(this)};
a.loadPlugin=function(b){var c=this.BaseUrl+"plugins/"+b+"/";b=c+b+".js?v="+STEditor.AppInfo.Build;c=c+"lang/"+this.Lang+".js?v="+STEditor.AppInfo.Build;try{STEditor.importScript(c);STEditor.importScript(b)}catch(d){alert(d)}};a.insertUBB=function(b){b=this.convertUBBToXHTML(b);this.insertHTML(b)};
a.insertHTML=function(b){if(b&&this.EditMode==1){this.EditorWindow.focus();try{this.loadSelection();if(this.Selection.type.toLowerCase()!="control")this.Range.pasteHTML(b);else this.Range.item(0).outerHTML=b}catch(c){this.executeEditorCommand("insertHTML",b)}}};a.executeEditorCommand=function(b,c){this.EditorWindow.focus();this.EditorWindow.document.execCommand(b,false,c)};a.getToolbarItemLinkId=function(b){return"ToolbarItemButton_"+b+"_"+this.TargetId};
a.getToolbarItemIconId=function(b){return"ToolbarItemIcon_"+b+"_"+this.TargetId};
a.loadToolbar=function(b){var c=this,d=c.Toolbar;d||(d=STEditor.ToolbarConfigs.All);if(b){var e="";for(var g in d){var f=d[g];if(f=="-")e+='<a href="javascript:void(0);" class="toolbar_seperator">&nbsp;</a>';else if(f=="|")e+='<div class="toolbar_line">&nbsp;</div>';else{c.isPlugin(f)&&c.loadPlugin(f);var h=c.getToolbarItemLinkId(f),i=c.getToolbarItemIconId(f);title=c.getLang(f+"_command")||"";e+='<a id="'+h+'" href="javascript:void(0);" class="toolbar_item" data="'+f+'" lang="'+c.Lang+'" title="'+
title+'"><span id="'+i+'" style="background-image:url(\''+c.BaseUrl+"/themes/"+c.Skin+"/images/tool/"+f+'.gif\');" data="'+f+'">&nbsp;</span></a>'}}e+='<div style="display:block;clear:both;height:0px;"></div>';b.innerHTML=e;STEditor.attachEvent(window,"load",function(){for(var k in d){var j=d[k];if(j!="-"&&j!="|"){j=c.getToolbarItemLinkId(j);if(j=STEditor.getObject(j)){STEditor.attachEvent(j,"click",function(m){m=(m.target||window.event.srcElement).getAttribute("data");c.executeToolbarItem(m)});var l=
j.getAttribute("data"),n=j.getAttribute("lang");j.getAttribute("title")||j.setAttribute("title",STEditor.Lang[n][l+"_command"])}}}})}};
a.init=function(){var b=this,c=STEditor.getObject(b.TargetId);if(c){STEditor.isset(STEditor.Lang[b.Lang])||(STEditor.Lang[b.Lang]={});b.BaseUrl=STEditor.getBaseUrl();b.buildStyleSheet();b.buildLangScript();var d=c.name,e=c.value,g=c.offsetWidth,f=c.offsetHeight,h=c.parentNode;if(typeof b.Size.Width!="number")b.Size.Width=g;if(typeof b.Size.Height!="number")b.Size.Height=f;f=document.createElement("div");f.setAttribute("id",b.TargetId+"_EditorContainer");f.setAttribute("lang",b.Lang);f.style.width=
g+"px";f.className="STEditorContainer_"+b.Skin;h.appendChild(f);h.replaceChild(f,c);b.Offset.Position=f.style.position;b.Offset.Top=f.style.top;b.Offset.Left=f.style.left;b.Offset.ZIndex=f.style.zIndex;c=document.createElement("textarea");c.style.display="none";c.id=b.TargetId;c.name=d;f.appendChild(c);b.FormInput=c;d=document.createElement("div");d.setAttribute("id",b.TargetId+"_ToolbarPanel");d.className="STEditorToolbarPanel";f.appendChild(d);b.loadToolbar(d);d=d.offsetHeight;c=document.createElement("div");
c.setAttribute("id",b.TargetId+"_EditorFactory");c.style.display="none";f.appendChild(c);c=document.createElement("textarea");c.setAttribute("id",b.TargetId+"_SourceBox");c.style.padding="5px";c.style.width=b.Size.Width-10+"px";c.style.maxWidth=b.Size.Width-10+"px";c.style.height=b.Size.Height-d-15+"px";c.style.maxHeight=b.Size.Height-d-15+"px";c.style.display="none";c.className="source_textbox";f.appendChild(c);g=b.TargetId+"_EditorArea";h=document.createElement("iframe");h.setAttribute("id",g);
h.setAttribute("frameBorder","0");h.setAttribute("allowTransparency","true");h.style.width=b.Size.Width+"px";h.style.height=b.Size.Height-d+"px";h.className="STEditorArea";f.appendChild(h);b.EditorWindow=STEditor.getIFrameWindow(g);f='<!DOCTYPE html><html><head xmlns="http://www.w3.org/1999/xhtml"><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"><link href="'+b.BaseUrl+"themes/"+b.Skin+"/editor_area.css?v="+STEditor.AppInfo.Build+'" rel="stylesheet" type="text/css" /></head><body contentEditable="true" dir="ltr"><p></p></body></html>';
if(STEditor.getIEVersion()<=7)b.EditorWindow.document.designMode="on";b.EditorWindow.document.open();b.EditorWindow.document.writeln(f);b.EditorWindow.document.close();b.EditorWindow.document.body.style.minHeight=b.Size.Height-d-15+"px";STEditor.attachEvent(c,"blur",function(){var i=STEditor.getObject(b.TargetId+"_SourceBox").value;b.EditMode=1;i=b.convertUBBToXHTML(i);b.EditorWindow.document.body.innerHTML=i;b.setFormInputValue()});STEditor.attachEvent(b.EditorWindow,"blur",function(){b.setFormInputValue()});
STEditor.attachEvent(b.EditorWindow,"keypress",function(){if(b.EditMode==1)b.EditorWindow.document.getElementsByTagName("p")[0]||b.executeEditorCommand("formatblock","<p>")});STEditor.attachEvent(window,"load",function(){if(b.UBBMode==1)e=b.convertUBBToXHTML(e);if(e){b.EditorWindow.focus();var i="",k=e;if(k.indexOf("<p>")!=-1)i=k;else{k=k.split("<br />");for(var j=0;j<k.length;j++)i=i+"<p>"+k[j]+"</p>\r\n"}b.EditorWindow.document.body.innerHTML=i}b.setFormInputValue()})}};
